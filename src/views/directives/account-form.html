<form name="editAccount" class="account-editor" novalidate="novalidate">
	<div class="control-group">
		<div class="form-group" ng-class="{ 'has-error': hasError(selectedAccount, 'name', editAccount.txtAccountName, forceDirty) }">
			<label class="control-label" for="txtAccountName">Account Name <span class="error">*</span></label>
			<input type="text" id="txtAccountName" name="txtAccountName" class="form-control" ng-model="selectedAccount.name"
					error-message error-message-item="selectedAccount" error-message-property="'name'" error-message-control="editAccount.txtAccountName" />
		</div>
		<div class="form-group" ng-class="{ 'has-error': hasError(selectedAccount, 'active', editAccount.selStatus, forceDirty) }">
			<label class="control-label" for="selStatus">Status <span class="error">*</span></label>
			<select id="selStatus" name="selStatus" class="form-control" ng-model="selectedAccount.active" ng-disabled="selfEditing"
					error-message error-message-item="selectedAccount" error-message-property="'active'" error-message-control="editAccount.selStatus"
					ng-options="value.key as value.name for value in activeOptions">
			</select>
		</div>
		<div class="form-group" ng-hide="selfEditing">
			<a href="#" ng-click="impersonateAccount()">Login as {{ selectedAccount.title }} Site Admin</a>
		</div>
	</div>

	<div class="control-group">
		<div class="form-group" ng-class="{ 'has-error': hasError(selectedAccount, 'address1', editAccount.txtAddress1, forceDirty) }">
			<label class="control-label" for="txtAddress1">Address 1 <span class="error">*</span></label>
			<input type="text" id="txtAddress1" name="txtAddress1" class="form-control" ng-model="selectedAccount.address1"
					error-message error-message-item="selectedAccount" error-message-property="'address1'" error-message-control="editAccount.txtAddress1" />
		</div>
		<div class="form-group">
			<label class="control-label" for="txtAddress2">Address 2</label>
			<input type="text" id="txtAddress2" name="txtAddress2" class="form-control" ng-model="selectedAccount.address2" />
		</div>
		<div class="form-group" ng-class="{ 'has-error': hasError(selectedAccount, 'city', editAccount.txtCity, forceDirty) }">
			<label class="control-label" for="txtCity">City <span class="error">*</span></label>
			<input type="text" id="txtCity" name="txtCity" class="form-control" ng-model="selectedAccount.city"
					error-message error-message-item="selectedAccount" error-message-property="'city'" error-message-control="editAccount.txtCity" />
		</div>
	</div>

	<div class="control-group">
		<div class="form-group" ng-class="{ 'has-error': hasError(selectedAccount, 'country', editAccount.selCountry, forceDirty) }">
			<label class="control-label" for="selCountry">Country <span class="error">*</span></label>
			<select id="selCountry" name="selCountry" class="form-control" ng-model="selectedAccount.country"
					error-message error-message-item="selectedAccount" error-message-property="'country'" error-message-control="editAccount.selCountry">
				<option value="Australia">Australia</option>
				<option value="Canada">Canada</option>
				<option value="UK">UK</option>
				<option value="USA">USA</option>
			</select>
		</div>
		<div class="form-group" ng-class="{ 'has-error': hasError(selectedAccount, 'state', editAccount.selState, forceDirty) }">
			<label class="control-label" for="selState">State/Prov <span class="error">*</span></label>
			<select id="selState" name="selState" class="form-control" ng-model="selectedAccount.state"
					ng-options="s.name for s in states track by s.value"
					ng-disabled="selectedAccount.country == 'Australia' || selectedAccount.country == 'UK'"
					error-message error-message-item="selectedAccount" error-message-property="'state'" error-message-control="editAccount.selState"></select>
		</div>
		<div class="form-group" ng-class="{ 'has-error': hasError(selectedAccount, 'postalCode', editAccount.txtPostalCode, forceDirty) }">
			<label class="control-label" for="txtPostalCode">Postal Code <span class="error">*</span></label>
			<input type="text" id="txtPostalCode" name="txtPostalCode" class="form-control" ng-model="selectedAccount.postalCode"
					error-message error-message-item="selectedAccount" error-message-property="'postalCode'" error-message-control="editAccount.txtPostalCode" />
		</div>
	</div>

	<div class="control-group">
		<div class="form-group" ng-class="{ 'has-error': hasError(selectedAccount, 'email', editAccount.txtEmail, forceDirty) }">
			<label class="control-label" for="txtEmail">Email <span class="error">*</span></label>
			<input type="text" required="required" id="txtEmail" name="txtEmail" class="form-control" ng-model="selectedAccount.email"
					error-message error-message-item="selectedAccount" error-message-property="'email'" error-message-control="editAccount.txtEmail" />
		</div>
		<div class="form-group" ng-class="{ 'has-error': hasError(selectedAccount, 'phoneNumber', editAccount.txtPhoneNumber, forceDirty) }">
			<label class="control-label" for="txtPhoneNumber">Phone <span class="error">*</span></label>
			<input type="text" id="txtPhoneNumber" name="txtPhoneNumber" class="form-control" ng-model="selectedAccount.phoneNumber"
					error-message error-message-item="selectedAccount" error-message-property="'phoneNumber'" error-message-control="editAccount.txtPhoneNumber" />
		</div>
		<div class="form-group" ng-hide="selfEditing">
			<a href="#" ng-click="resendAccountCreationEmail($event)">Resend Account Creation Email</a>
		</div>
	</div>

	<h2>Subscription Info</h2>

	<div class="row">
		<div class="col-md-4">
			<div class="control-group" ng-show="!selfEditing">
				<div class="form-group" ng-class="{ 'has-error': hasError(selectedAccount, 'subscription', editAccount.selSubscription, forceDirty) }">
					<label class="control-label" for="selSubscription">Subscription Level <span class="error">*</span></label>
					<select id="selSubscription" name="selSubscription" class="form-control"
							ng-model="selectedAccount.subscription" ng-change="changeTier()" ng-options="s.getName() for s in subscriptions track by s.subscriptionLevel"
							error-message error-message-item="selectedAccount" error-message-property="'subscription'" error-message-control="editAccount.selSubscription">
					</select>
				</div>
			</div>

			<div class="control-group">
				<label class="radio-inline"><input type="radio" name="radPaymentPeriod" id="radMonthly" ng-value="false" ng-model="selectedAccount.yearlyPayment" ng-change="changePaymentPeriod()" />Monthly Payment</label>
				<label class="radio-inline"><input type="radio" name="radPaymentPeriod" id="radYearly" ng-value="true" ng-model="selectedAccount.yearlyPayment" ng-change="changePaymentPeriod()" />Annual Payment (<span>{{ selectedAccount.subscription.annualDiscount }}</span>% discount)</label>
			</div>

			<div class="control-group">
				<div class="checkbox">
					<label class="control-label" for="chkAutoRenew">
						<input type="checkbox" id="chkAutoRenew" ng-model="selectedAccount.autoRenew" ng-disabled="!selectedAccount.yearlyPayment" />
						Account Auto Renew
					</label>
				</div>
			</div>

			<div class="control-group">
				Account Renew/Expiration Date: <span ng-bind="selectedAccount.formattedExpirationDate()"></span>
			</div>

			<div class="control-group">
				<div class="form-group" ng-class="{ 'has-error': hasError(selectedAccount.subscription, 'numberLicenses', editAccount.txtMaxNumUsers, forceDirty) }" ng-hide="selfEditing">
					<label class="control-label" for="txtMaxNumUsers">Max # of Users <span class="error">*</span></label>
					<input type="text" required="required" id="txtMaxNumUsers" name="txtMaxNumUsers" class="form-control"
							ng-model="selectedAccount.subscription.numberLicenses" ng-disabled="selfEditing"
							error-message error-message-item="selectedAccount.subscription" error-message-property="'numberLicenses'" error-message-control="editAccount.txtMaxNumUsers" />
				</div>
				
				<div class="control-group btn-group" ng-show="selfEditing">
					<button type="button" class="btn btn-default" ng-show="!selectedAccount.autoRenew" ng-click="renewAccount()">Renew Account</button>
					<button type="button" class="btn btn-default" ng-click="cancelAccount()">Cancel Account</button>
				</div>
			</div>
		</div>

		<div class="col-md-8">
			<div class="tier-components">
				<div style="display: inline-block;" tier-tiles selected-subscription="selectedAccount.subscription"></div>

				<div class="tier-info">
					<ul class="tier-info-list">
						<li>
							<div class="tier-info-label">Price / Month:</div>
							<div class="tier-info-data">${{ selectedAccount.subscription.formatPricePerMonth(selectedAccount.yearlyPayment) }}</div>
						</li>
						<li>
							<div class="tier-info-label">Max # Users:</div>
							<div class="tier-info-data">{{ selectedAccount.subscription.numberLicenses }}</div>
						</li>
						<li>
							<div class="tier-info-label">Training:</div>
							<div class="tier-info-data">{{ (selectedAccount.subscription.training === true ? 'Included' : 'Not Included') }}</div>
						</li>
						<li>
							<div class="tier-info-label">Additional Features:</div>
							<div class="tier-info-data">{{ selectedAccount.subscription.features }}</div>
						</li>
					</ul>
					
					<div class="control-group btn-group">
						<button type="button" class="btn btn-default" ng-click="compareTiers()" ng-show="selfEditing">Compare Tiers</button>
					</div>
				</div>
			</div>
		</div>
	</div>

	<div class="content-strategy">
		<h2>{{ isGlobalAdmin ? 'Set' : 'Our' }} Content Strategy</h2>

		<div ng-repeat="item in selectedAccount.strategy track by item.id">
			<input class="form-control" style="width: 333px; margin-bottom: 16px; display: inline-block;" type="text" ng-model="item.text">
			<span ng-click="deleteStrategyItem(item)" class="fa fa-trash-o"></span>
		</div>

		<button class="btn btn-inverse" ng-click="addStrategyItem()">
			Add Bullet 
		</button>
	</div>

	<h2>Payment Info</h2>

	<div ng-if="selectedAccount.hasToken">
		<p>Stored payment type: {{ selectedAccount.tokenizedType }}</p>
	</div>

	<div class="control-group">
		<label class="radio-inline"><input type="radio" name="radPaymentMethod" id="radCreditCard" ng-value="'CC'" ng-model="selectedAccount.paymentType" />Credit Card</label>
		<label class="radio-inline"><input type="radio" name="radPaymentMethod" id="radACH" ng-value="'ACH'" ng-model="selectedAccount.paymentType" />ACH</label>
	</div>

	<div ng-show="selectedAccount.paymentType === 'CC'">
		<div class="control-group">
			<div class="form-group" ng-class="{ 'has-error': hasError(selectedAccount.creditCard, 'nameOnCard', editAccount.txtNameOnCard, forceDirty) }">
				<label class="control-label" for="txtNameOnCard">Name on Card <span class="error">*</span></label>
				<input type="text" id="txtNameOnCard" name="txtNameOnCard" class="form-control" ng-model="selectedAccount.creditCard.nameOnCard"
					error-message error-message-item="selectedAccount.creditCard" error-message-property="'nameOnCard'" error-message-control="editAccount.txtNameOnCard" />
			</div>
			<div class="form-group" ng-class="{ 'has-error': hasError(selectedAccount.creditCard, 'cardType', editAccount.selCardType, forceDirty) }">
				<label class="control-label" for="selCardType">Card Type <span class="error">*</span></label>
				<select id="selCardType" name="selCardType" class="form-control" ng-model="selectedAccount.creditCard.cardType"
					error-message error-message-item="selectedAccount.creditCard" error-message-property="'cardType'" error-message-control="editAccount.selCardType">
					<option value="VISA">Visa</option>
					<option value="MASTERCARD">MasterCard</option>
					<option value="AMEX">American Express</option>
					<option value="DISCOVER">Discover</option>
				</select>
			</div>
			<div class="form-group" ng-class="{ 'has-error': hasError(selectedAccount.creditCard, 'cardNumber', editAccount.txtCardNumber, forceDirty) }">
				<label class="control-label" for="txtCardNumber">Card Number <span class="error">*</span></label>
				<input type="text" id="txtCardNumber" name="txtCardNumber" class="form-control" ng-model="selectedAccount.creditCard.cardNumber"
					error-message error-message-item="selectedAccount.creditCard" error-message-property="'cardNumber'" error-message-control="editAccount.txtCardNumber" />
			</div>
		</div>

		<div class="control-group">
			<div class="form-group" ng-class="{ 'has-error': hasError(selectedAccount.creditCard, 'cvc', editAccount.txtCVCNumber, forceDirty) }">
				<label class="control-label" for="txtCVCNumber">CVC <span class="error">*</span></label>
				<input type="text" id="txtCVCNumber" name="txtCVCNumber" class="form-control" ng-model="selectedAccount.creditCard.cvc"
					error-message error-message-item="selectedAccount.creditCard" error-message-property="'cvc'" error-message-control="editAccount.txtCVCNumber" />
			</div>
			<div class="form-group" ng-class="{ 'has-error': hasError(selectedAccount.creditCard, 'expirationDateMonth', editAccount.selExpirationMonth, forceDirty) }">
				<label class="control-label" for="selExpirationMonth">Expir. Month <span class="error">*</span></label>
				<select id="selExpirationMonth" name="selExpirationMonth" class="form-control" ng-model="selectedAccount.creditCard.expirationDateMonth"
					error-message error-message-item="selectedAccount.creditCard" error-message-property="'expirationDateMonth'" error-message-control="editAccount.selExpirationMonth">
					<option value="1">Jan</option>
					<option value="2">Feb</option>
					<option value="3">Mar</option>
					<option value="4">Apr</option>
					<option value="5">May</option>
					<option value="6">Jun</option>
					<option value="7">Jul</option>
					<option value="8">Aug</option>
					<option value="9">Sep</option>
					<option value="10">Oct</option>
					<option value="11">Nov</option>
					<option value="12">Dec</option>
				</select>
			</div>
			<div class="form-group" ng-class="{ 'has-error': hasError(selectedAccount.creditCard, 'expirationDateYear', editAccount.selExpirationYear, forceDirty) }">
				<label class="control-label" for="selExpirationYear">Expir. Year <span class="error">*</span></label>
				<select id="selExpirationYear" name="selExpirationYear" class="form-control"
					ng-model="selectedAccount.creditCard.expirationDateYear" ng-options="year for year in years"
					error-message error-message-item="selectedAccount.creditCard" error-message-property="'expirationDateYear'" error-message-control="editAccount.selExpirationYear"></select>
			</div>
		</div>

		<div class="control-group">
			<div class="form-group" ng-class="{ 'has-error': hasError(selectedAccount.creditCard, 'postalCode', editAccount.txtCCPostalCode, forceDirty) }">
				<label class="control-label" for="txtCCPostalCode">Postal Code <span class="error">*</span></label>
				<input type="text" id="txtCCPostalCode" name="txtCCPostalCode" class="form-control" ng-model="selectedAccount.creditCard.postalCode"
					error-message error-message-item="selectedAccount.creditCard" error-message-property="'postalCode'" error-message-control="editAccount.txtCCPostalCode" />
			</div>
		</div>
	</div>

	<div ng-show="selectedAccount.paymentType === 'ACH'">
		<div class="control-group">
			<div class="form-group" ng-class="{ 'has-error': hasError(selectedAccount.bankAccount, 'bankName', editAccount.txtBankName, forceDirty) }">
				<label class="control-label" for="txtBankName">Bank Name <span class="error">*</span></label>
				<input type="text" id="txtBankName" name="txtBankName" class="form-control" ng-model="selectedAccount.bankAccount.bankName"
					error-message error-message-item="selectedAccount.bankAccount" error-message-property="'bankName'" error-message-control="editAccount.txtBankName" />
			</div>
			<div class="form-group" ng-class="{ 'has-error': hasError(selectedAccount.bankAccount, 'routingNumber', editAccount.txtRoutingNumber, forceDirty) }">
				<label class="control-label" for="txtRoutingNumber">Routing Number <span class="error">*</span></label>
				<input type="text" id="txtRoutingNumber" name="txtRoutingNumber" class="form-control" ng-model="selectedAccount.bankAccount.routingNumber"
					error-message error-message-item="selectedAccount.bankAccount" error-message-property="'routingNumber'" error-message-control="editAccount.txtRoutingNumber" />
			</div>
		</div>

		<div class="control-group">
			<div class="form-group" ng-class="{ 'has-error': hasError(selectedAccount.bankAccount, 'accountNumber', editAccount.txtAccountNumber, forceDirty) }">
				<label class="control-label" for="txtAccountNumber">Account Number <span class="error">*</span></label>
				<input type="text" id="txtAccountNumber" name="txtAccountNumber" class="form-control" ng-model="selectedAccount.bankAccount.accountNumber"
					error-message error-message-item="selectedAccount.bankAccount" error-message-property="'accountNumber'" error-message-control="editAccount.txtAccountNumber" />
			</div>
		</div>
	</div>

	<div class="control-group btn-toolbar">
		<button type="button" class="btn btn-default ladda-button" ng-click="saveAccount(editAccount)" data-style="zoom-in" ladda-button="isSaving">
			<span class="ladda-label">Save</span>
		</button>
		<button type="button" class="btn btn-default" ng-click="cancelEdit(editAccount)">Cancel</button>
		<button type="button" class="btn btn-default" ng-click="deleteAccount(editAccount)" ng-show="!creatingNew && !selfEditing">Delete</button>
	</div>
</form>

<div class="full-screen-modal" ng-show="isSaving">
	<spinner spin="{ color: 'white', length: 50, width: 10, radius: 30 }"></spinner>
</div>