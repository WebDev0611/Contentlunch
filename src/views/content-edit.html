<div class="view create">
	<div class="col-md-3 left-pane">
		<div task-list task-groups="content.taskGroups" parent-status="content.status" author-id="content.author.id" users="taskUsers" ng-hide="isNewContent || !isCollaborator"></div>
	</div>
	<div class="col-md-9 right-pane" ng-show="isCollaborator">
		<h2 class="right-pane-header">Create</h2>

		<div class="content-editor row">
			<div class="col-md-9">
				<div class="create-content-header row">
					<div class="content-workflow col-md-6">
						<div class="content-workflow-item" ng-class="{ 'inactive': (content.status < 1) }">
							<span class="cl-icon cl-icon-white cl-icon-workflow-create"></span>
						</div>
						<div class="content-workflow-item" ng-class="{ 'inactive': (content.status < 2) }">
							<span class="cl-icon cl-icon-white cl-icon-workflow-review"></span>
						</div>
						<div class="content-workflow-item" ng-class="{ 'inactive': (content.status < 4) }">
							<span class="cl-icon cl-icon-white cl-icon-workflow-launch"></span>
						</div>
						<div class="content-workflow-item" ng-class="{ 'inactive': (content.status < 5) }">
							<span class="cl-icon cl-icon-white cl-icon-workflow-promote"></span>
						</div>
			
						<div class="content-workflow-connector-1" ng-class="{ 'inactive': (content.status < 1) }"></div>
						<div class="content-workflow-connector-2" ng-class="{ 'inactive': (content.status < 2) }"></div>
						<div class="content-workflow-connector-3" ng-class="{ 'inactive': (content.status < 4) }"></div>
					</div>
		
					<div class="col-md-6">
						<h3>Concept</h3>
						<i ng-bind-html="content.concept"></i>
					</div>
				</div>
					
				<h2>Create Content</h2>
				
				<div class="content-approved-header" ng-show="isReadOnly">
					Content is Approved
					<span class="fa fa-thumbs-o-up"></span>
				</div>

				<form name="editContent" novalidate="novalidate">
					<div class="control-group">
						<div class="form-group form-group-wide" ng-class="{ 'has-error': hasError(content, 'title', editContent.txtContentName, forceDirty) }">
							<label class="control-label" for="txtContentName">Content Title</label>
							<input type="text" name="txtContentName" id="txtContentName" class="form-control" ng-model="content.title" ng-disabled="isReadOnly"
									error-message message="errorMessage(content, 'title', editContent.txtContentName)" />
						</div>
						<div class="form-group">
							&nbsp;<br/>
							<a href="#" ng-click="showPublishingGuidelines()">Publishing Guidelines</a>
						</div>
					</div>
					
					<div class="control-group">
						<div class="form-group" ng-class="{ 'has-error': hasError(content, 'contentType.name', editContent.selContentType, forceDirty) }">
							<label class="control-label" for="selContentType">Content Type</label>
							<select name="selContentType" id="selContentType" ng-disabled="!isNewContent || isReadOnly"
									ui-select2="{ formatResult: formatContentTypeItem, formatSelection: formatContentTypeItem, selectOnBlur: true }" ng-model="content.contentType.name"
									data-placeholder="Select Content Type" error-message message="errorMessage(content, 'contentType.name', editContent.selContentType)" ng-change="updateContentType()">
								<option value=""></option>
								<option ng-repeat="ct in contentTypes" value="{{ ct.name }}">{{ ct.title }}</option>
							</select>
						</div>

						<div class="form-group" ng-class="{ 'has-error': hasError(content, 'author', editContent.selAuthor, forceDirty) }">
							<label class="control-label" for="selCreator">Content Creator</label>
							<select name="selAuthor" id="selAuthor" ng-disabled="isReadOnly"
									ui-select2="{ formatResult: formatUserItem, formatSelection: formatUserItem, selectOnBlur: true }" ng-model="content.author.id"
									data-placeholder="Select Content Creator" error-message message="errorMessage(content, 'author', editContent.selAuthor)" ng-change="updateAuthor()">
								<option value=""></option>
								<option ng-repeat="u in users" value="{{ u.id }}">{{ u.formatName() }}</option>
							</select>
						</div>
					</div>

					<div class="control-group">
						<div class="form-group" ng-class="{ 'has-error': hasError(content, 'accountConnections', editContent.selContentConnections, forceDirty) }">
							<label class="control-label" for="selContentConnections">Content Connections</label>
							<select id="selContentConnections" name="selContentConnections" class="multi-select" multiple="multiple" ng-disabled="isReadOnly"
									ui-select2="{ formatResult: formatContentConnectionItem, formatSelection: formatContentConnectionItem }" ng-model="contentConnectionIds"
									data-placeholder="Select Content Connection" error-message message="errorMessage(content, 'accountConnections', editContent.selContentConnections)">
								<option ng-repeat="cc in contentConnections" value="{{ cc.id }}">{{ cc.name }}</option>
							</select>
						</div>
					</div>

					<div class="control-group" ng-show="showAddFileButton">
						<div class="content-file-view" ng-show="!!content.contentFile">
							<button type="button" class="btn btn-lg btn-black btn-default" onclick="$('#filContentFile').click()" ng-hide="isReadOnly">
								<span class="fa fa-paperclip"></span>
								Replace File
							</button>

							Content File: 
							<span class="cl-icon" ng-class="content.contentFile.fileType()"></span>
							<a href="{{ content.contentFile.path }}" target="_new">{{ content.contentFile.fileName }}</a>
							
							<span class="fa fa-trash-o" ng-click="deleteContentFile()" ng-hide="isReadOnly"></span>
						</div>

						<button type="button" class="btn btn-lg btn-black btn-default" onclick="$('#filContentFile').click()" ng-show="!content.contentFile && !isReadOnly">
							<span class="fa fa-paperclip"></span>
							Add a File
						</button>
		
						<input type="file" id="filContentFile" ng-file-select="uploadContentFile($files, editContent, editContent.filContentFile)" />
						<progressbar class="progress-striped active" value="percentComplete" ng-show="isUploading">
							<span>{{ percentComplete }}%</span>
						</progressbar>
					</div>

					<div class="control-group" ng-show="showRichTextEditor" ng-class="{ 'has-error': hasError(content, 'body', editContent.txtContentDesc, forceDirty) }" ng-hide="isReadOnly">
						<textarea name="txtContentDesc" id="txtContentDesc" rich-text-editor ng-model="content.body"
								error-message message="errorMessage(content, 'body', editContent.txtContentDesc)"></textarea>
					</div>
					
					<div class="content-preview" ng-show="isReadOnly">
						<h4>{{ content.title }}</h4>
						
						<div ng-bind-html="content.body"></div>
					
						<div class="control-group">
							<button type="button" class="btn btn-lg btn-default btn-launch" ng-click="submitContent()" ng-disabled="!canLaunchContent" ng-show="content.status === 3">
								<span class="cl-icon cl-icon-launch"></span>
								<span>LAUNCH CONTENT</span>
							</button>
						</div>
					</div>

					<div class="control-group">
						<div class="form-group">
							<label for="txtTags">Tags</label> (separate by comma)
							<textarea name="txtTags" id="txtTags" class="form-control" ng-model="contentTags" ng-disabled="isReadOnly"></textarea>
						</div>

						<div class="form-group">
							<label for="txtRelatedContent">Related Content</label> (separate by comma)
							<textarea name="txtRelatedContent" id="txtRelatedContent" class="form-control" ng-model="content.relatedContent" ng-disabled="isReadOnly"></textarea>
						</div>
					</div>

					<div class="control-group">
						<div class="form-group" ng-class="{ 'has-error': hasError(content, 'buyingStage', editContent.selBuyingStage, forceDirty) }">
							<label for="selBuyingStage">Buying Stage</label>
							<select name="selBuyingStage" id="selBuyingStage" ng-disabled="isReadOnly"
									ui-select2="{ formatResult: formatBuyingStageItem, formatSelection: formatBuyingStageItem, allowClear: true }" ng-model="content.buyingStage"
									data-placeholder="Select Buying Stage" error-message message="errorMessage(content, 'buyingStage', editContent.selBuyingStage)">
								<option value=""></option>
								<option ng-repeat="bs in buyingStages" value="{{ $index }}">{{ bs }}</option>
							</select>
						</div>

						<div class="form-group" ng-class="{ 'has-error': hasError(content, 'persona', editContent.selPersona, forceDirty) }">
							<label for="selPersona">Persona</label>
							<select name="selPersona" id="selPersona" ng-disabled="isReadOnly"
									ui-select2="{ allowClear: true }" ng-model="content.persona"
									data-placeholder="Select Persona" error-message message="errorMessage(content, 'persona', editContent.selPersona)">
								<option value=""></option>
								<option ng-repeat="p in contentSettings.personas" value="{{ p.name }}">{{ p.name }}</option>
							</select>
						</div>

						<div class="form-group" ng-class="{ 'has-error': hasError(content, 'campaign', editContent.selCampaign, forceDirty) }">
							<label for="selCampaign">Campaign</label>
							<select name="selCampaign" id="selCampaign" ng-disabled="isReadOnly"
									ui-select2="{ formatResult: formatCampaignItem, formatSelection: formatCampaignItem, allowClear: true }" ng-model="content.campaign.id"
									data-placeholder="Select Campaign" error-message message="errorMessage(content, 'campaign', editContent.selCampaign)" ng-change="updateCampaign()">
								<option value=""></option>
								<option ng-repeat="c in campaigns" value="{{ c.id }}">{{ c.title }}</option>
							</select>
						</div>
					</div>
					
					<div class="control-group">
						<div class="form-group">
							<label for="selSecondaryBuyingStage">Secondary Buying Stage</label>
							<select name="selSecondaryBuyingStage" id="selSecondaryBuyingStage" ng-disabled="isReadOnly"
									ui-select2="{ formatResult: formatBuyingStageItem, formatSelection: formatBuyingStageItem, allowClear: true }" ng-model="content.secondaryBuyingStage"
									data-placeholder="Select Secondary Buying Stage">
								<option value=""></option>
								<option ng-repeat="bs in buyingStages" value="{{ $index }}">{{ bs }}</option>
							</select>
						</div>

						<div class="form-group">
							<label for="selSecondaryPersona">Secondary Persona</label>
							<select name="selSecondaryPersona" id="selSecondaryPersona" ng-disabled="isReadOnly"
									ui-select2="{ allowClear: true }" ng-model="content.secondaryPersona" data-placeholder="Select Secondary Persona">
								<option value=""></option>
								<option ng-repeat="p in contentSettings.personas" value="{{ p.name }}">{{ p.name }}</option>
							</select>
						</div>
					</div>

					<div class="control-group">
						<button type="button" class="btn btn-lg btn-black btn-default" ng-click="saveContent()" ng-show="canEditContent && !isReadOnly">Save</button>
						<button type="button" class="btn btn-lg btn-black btn-default" ng-click="submitContent()" ng-show="canSubmitContent && !isReadOnly">{{ getNextStepText() }}</button>
					</div>
					
					<div files-list="content.attachments" after-add-file-success="addAttachment" users="taskUsers" ng-hide="isNewContent" is-disabled="attachmentsIsDisabled"></div>
				</form>
			</div>
			<div class="col-md-3" ng-hide="isNewContent">
				<div collaborator-sidebar collaborators="content.collaborators" users="collaborators" item-id="content.id" item-type="'content'"
					add-collaborator-callback="filterTaskAssignees" remove-collaborator-callback="filterTaskAssignees" is-disabled="collboratorsIsDisabled"></div>
				
				<div ng-show="showExport">
					<div style="font-weight: bold;">Export to</div>
					<div class="cl-banner-container" ng-show="showExportHubspot" ng-click="exportContent('hubspot')">
						<span class="cl-banner cl-banner-hubspot"></span>
					</div>
					<div class="cl-banner-container" ng-show="showExportActOn" ng-click="exportContent('act-on')">
						<span class="cl-banner cl-banner-act-on"></span>
					</div>
				</div>
			</div>
		</div>
		<div class="row">
			<div class="col-md-12" ng-hide="isNewContent" discussion-panel discussion="content.comments" item-id="content.id" item-type="'content'" ng-hide="isNewContent"></div>
		</div>
	</div>
	<div class="col-md-9 right-pane" ng-hide="isCollaborator">
		<h3 class="unauthorized-message">You are unauthorized to view this content.</h3>
	</div>
</div>

<script type="text/ng-template" id="publishing-guidelines.html">
	<div class="modal-header">Publishing Guidelines</div>
	<div class="modal-body">
		{{ publishingGuidelines }}
	</div>
	<div class="modal-footer">
		<button class="btn btn-primary" ng-click="ok()">OK</button>
	</div>
</script>

<script type="text/ng-template" id="select-user-to-complete.html">
	<div class="modal-header">Select User</div>
	<div class="modal-body">
		<div class="control-group">
			<p>You must assign someone with the necessary privileges to {{ taskName }} this item when it is complete. They will be assigned a task to {{ taskName }} this item.</p>
			<div class="form-group">
				<label for="selUserToAct">User</label>
				(items with a <span class="fa fa-check-circle"></span> are collaborators for this item)
				<select id="selUserToAct" name="selUserToAct" ng-model="userToCompleteId" ng-change="selectUserToComplete(userToCompleteId)"
					ui-select2="{ formatResult: formatUserItem, formatSelection: formatUserItem, selectOnBlur: true, allowClear: true }"
					data-placeholder="Select User">
					<option value=""></option>
					<option ng-repeat="a in userPool" value="{{ a.id }}">{{ a.formatName() }}</option>
				</select>
			</div>
		</div>
	</div>
	<div class="modal-footer">
		<button class="btn btn-primary" ng-click="save()">Select User</button>
		<button class="btn btn-primary" ng-click="cancel()">Cancel</button>
	</div>

</script>